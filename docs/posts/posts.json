[
  {
    "path": "posts/second_post/",
    "title": "Second post ",
    "description": "This is the second post.",
    "author": [
      {
        "name": "Camilo Febres-Molina",
        "url": "https://github.com/camilofm"
      }
    ],
    "date": "2022-08-25",
    "categories": [],
    "contents": "\nHere I can also write something interesting for my second post.\n\n\n\n",
    "preview": {},
    "last_modified": "2022-08-25T23:10:13-05:00",
    "input_file": {}
  },
  {
    "path": "posts/third_post/",
    "title": "Third post ",
    "description": "This is the third post.",
    "author": [
      {
        "name": "Camilo Febres-Molina",
        "url": "https://github.com/camilofm"
      }
    ],
    "date": "2022-08-25",
    "categories": [],
    "contents": "\n\nContents\nIntroduction\n\nIntroduction\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere\nnulla at mattis porta. Ut et nibh ex. Nunc eleifend vehicula cursus.\nQuisque dignissim sed erat nec efficitur. Pellentesque porta scelerisque\npurus ac dictum. Aenean commodo ex tortor, et vehicula diam ornare quis.\nSuspendisse scelerisque, ligula et hendrerit placerat, nisi massa\neleifend felis, ac porttitor orci odio a diam. Sed lobortis sollicitudin\ncommodo. Quisque velit mi, tempus a dui ac, gravida faucibus mauris.\nNulla egestas efficitur nulla non cursus. Fusce magna turpis, mollis ac\nvestibulum et, convallis viverra turpis. Aliquam erat volutpat. Maecenas\neu dignissim orci.\nMorbi iaculis a ipsum vel bibendum. Curabitur massa ante, rhoncus\neget magna eu, accumsan commodo nunc. Quisque massa felis, faucibus\nlacinia justo eget, euismod accumsan augue. Phasellus euismod mattis\nnisl, sed aliquet sapien feugiat a. Vestibulum tincidunt nulla a leo\nvarius blandit. Vivamus pretium risus dui, vel consequat risus gravida\nnon. Vivamus maximus tristique ultricies. Cras vitae sapien a magna\ntincidunt convallis. Mostly the purpose of this post is to show some\nbasic R scripting to manipulate and plot data.\n\nThe resveratrol molecule\n\n\n\n",
    "preview": {},
    "last_modified": "2022-08-26T11:48:45-05:00",
    "input_file": {}
  },
  {
    "path": "posts/tutorial_gromacs/",
    "title": "Análisis post producción de la dinámica molecular con Gromacs - Tutorial",
    "description": "Aquí veremos paso a paso cómo es que podemos utilizar la suite Gromacs para el análisis post producción de una dinámica molecular realizada con los programas Gromacs, CHARMM o NAMD.",
    "author": [
      {
        "name": "Camilo Febres-Molina",
        "url": "https://github.com/camilofm"
      }
    ],
    "date": "2022-08-25",
    "categories": [],
    "contents": "\n\n\n\nExisten muchas metodologías, softwares y servidores en línea\ndiseñados para analizar la trayectoria obtenida luego de la producción\nde una dinámica molecular (MD) para, así, obtener información que dé\ncuenta de la estabilidad de dicha corrida en un período específico, las\nfluctuaciones de ciertos residuos, entre otros. Sin embargo, el paquete\nde software Gromacs nos permite, en un solo lugar, realizar todos estos\nanálisis y muchos otros de forma relativamente simple y utilizando la\nlínea de comandos.\nEl presente tutorial abarcará los siguientes análisis post producción\nde la MD:\nRMSD\nRMSF, factor-B y estructura promedio\nRadio de giro\nSASA y energía libre de solvatación estimada\nMediciones: distancias, ángulos y diedros\nEstructura secundaria\nDensidad\nEnlaces de hidrógeno\nIndicaciones y\nrecomendaciones iniciales\nAntes de iniciar con los diferentes análisis se debe tener en cuenta\nque la trayectoria a utilizar sea la óptima, por ejemplo, que no\ncontenga “saltos” o algunas moléculas que parecieran estar “rotas”\ndebido a la periodicidad de contorno (PBC) durante la MD. Por lo que es\nuna buena práctica realizar la revisión de dicha trayectoria (en algún\nvisualizador, como VMD) o, en su defecto, utilizar el programa trjconv\npara restaurar dichos “saltos” o “rupturas” como veremos en el punto 2.\nA lo largo de este tutorial, y a modo de ejemplo, se utilizarán los\nsiguientes archivos de entrada iniciales: coor.pdb, traj.dcd y topol.psf\n(suponiendo que son estos archivos con sus extensiones los que se\nobtuvieron al realizar la MD luego de correrlos en NAMD o AMBER, por\nejemplo). Lo primero que se debe hacer es convertir la trayectoria\ntraj.dcd a un formato que gromacs utilice y pueda manejar, como traj.trr\no traj.xtc, por lo que a través del programa VMD, y luego de cargar toda\nla trayectoria (topol.psf + traj.dcd), se guardará dicha trayectoria (en\n“File” -> “Save coordinates” -> “File type”) con la extensión\n“trr”. El único inconveniente al convertir la trayectoria a este\nformato, y no obtenerlo de forma nativa (habiendo corrido la MD con\nGromacs), es que las etiquetas de tiempo deberán corregirse luego con el\ngraficador que utilicemos (por ejemplo, con Grace).\nTratamiento adecuado de\nla trayectoria\nEl programa trjconv se utiliza básicamente para convertir la\ntrayectoria trr (generalmente pesada) en otra comprimida y más manejable\nxtc. Además también se utilizará a continuación para reparar algún\nproblema de PBC en la trayectoria inicial. En la misma carpeta en la que\nestén los archivos de entrada que se tienen hasta ahora (y donde debe\nestar también traj.trr) se generará un archivo pdb con las coordinadas\ndel frame inicial de la trayectoria (también se puede utilizar VMD para\nesto) y se llamará coor-tpr.pdb, esto con la intención de utilizarlo en\nvez del archivo tpr que requieren todos los programas de Gromacs y que\nsirve de coordenadas de referencia. Una vez hecho esto, y en la\nmencionada carpeta, se correrá la siguiente línea de comando en la\nterminal: gmx trjconv -f traj.trr -s coor-tpr.pdb -o traj.xtc -pbc mol\n-ur compact -center -> Para centrar, escoger la opción “proteína” y\ncomo salida la opción “sistema”. Con lo que el archivo de salida aquí\nserá traj.xtc y es el que se utilizará de ahora en adelante para los\nsiguientes análisis. Cabe mencionar aquí que así no existan problemas de\n“saltos” o “rupturas” en nuestra trayectoria original (traj.dcd) es una\nbuena práctica utilizar las opciones -pbc mol, -ur compact y -center, ya\nque no afectarán en nada en el caso de que no se necesiten.\nRMSD\nSe correrá la siguiente línea de comando para generar un archivo para\nser posteriormente graficado: gmx rms -f traj.xtc -s coor-tpr.pdb -o\nrmsd.xvg -> Aquí se escogerá a la “proteína” en ambas opciones para\nque el cálculo de la desviación media cuadrática sea para esa estructura\núnicamente y no para todo el sistema. Una vez generado el archivo de\nsalida rmsd.xvg se podrá utilizar un programa (por defecto el formato de\ndicho archivo es para el programa Grace) para obtener la gráfica RMSD de\nla proteína a lo largo de la MD. Como se mencionó en el punto 1, se debe\ncorregir la etiqueta del tiempo en dicho graficador (que por defecto\nestá en ps). Nota: En el caso de que, aún habiendo realizado el comando\ndel punto 2, se visualice un salto abrupto (anormal) en la gráfica del\nRMSD, se puede correr las siguientes líneas de comando para intentar\narreglar el problema: i) gmx trjconv -f traj.xtc -s coor-tpr.pdb -o\ntraj_no-jump.xtc -pbc nojump ii) gmx trjconv -f traj_no-jump.xtc -s\ncoor-tpr.pdb -o traj_fit.xtc -fit rot+trans Haciendo esto y luego\nrecalculando el RMSD con: gmx rms -f traj_fit.xtc -s coor-tpr.pdb -o\nrmsd_fit.xvg Se obtendrá el nuevo archivo de salida rmsd_fit.xvg con el\ncual muy probablemente ya se pueda generar una gráfica RMSD corregida y\nsin saltos anormales. Sólo si éste es el caso, entonces para lo que\nresta del tutorial se deberá utilizar el archivo traj_fit.xtc cada que\nse vea traj.xtc ya que es el corregido. En el caso de que la primera\ngráfica (aquella generada con rmsd.xvg) esté sin anormalidades se\nutilizará el archivo traj.xtc para lo que resta de los análisis.\nRMSF, factor-B y estructura\npromedio\nA continuación se generarán archivos para poder graficar las\nfluctuaciones por residuo, un pdb que contiene en la columna beta la\ninformación sobre dichas fluctuaciones para luego poder representarlo en\ncolores (en VMD, por ejemplo) y otro pdb que contendrá las coordenadas\nde la estructura promedio de la trayectoria (o segmento que se escoja de\nella). Primero, a través de la gráfica del RMSD anterior, se\nseleccionará la parte de la trayectoria que sea estable para utilizarla.\nRecordar que por defecto Gromacs utiliza los ps como unidad de tiempo,\npor lo que se debe conocer el intervalo estable de la mencionada\ntrayectoria en ps (se puede lograr esto viendo el eje x en el gráfico\nRMSD antes de haber corregido los tiempos a ns, como se mencionó en los\npuntos 1 y 3). Para esto, se correrá la siguiente línea de comando: gmx\nrmsf -f traj.xtc -s coor-tpr.pdb -oq coor_bfac.pdb -ox coor_avrg.pdb -o\nrmsf.xvg -res -b A -e B -> Se deberá escoger sólo la proteína para\nrealizar el cálculo. -> A y B son los tiempos (en ps) del primer y\núltimo frame, respectivamente, para ser leídos de la trayectoria\ncompleta. Por ejemplo, en el caso que se tenga una trayectoria total de\n10 ps (probablemente de 100 ns - recordar que así lee Gromacs las\ntrayectorias que originalmente son dcd y se convirtieron a trr en VMD) y\nse sepa que la parte estable es a partir del ps 4.5 (ns 45) hasta el\nfinal, entonces, los valores de A y B para la anterior línea de comando\nserían 4.5 y 10, respectivamente. De esta manera se podrá graficar el\narchivo de salida rmsf.xvg para obtener el RMSF (por residuo). Así como\ntambién se habrán generado los archivos coor_bfac.pdb y coor_avrg.pdb\nlos que dan cuenta de las coordenadas de la proteína (de referencia -\nframe inicial) con el factor-B y coordenadas de la estructura promedio,\nrespectivamente, únicamente del intervalo de la trayectoria antes\nescogido.\nRadio de giro\nCalcular el radio de giro de una proteína sobre los ejes x, y, z como\nfunción del tiempo es útil para conocer el grado de compactación que\npudo haber sufrido esta estructura a lo largo de la trayectoria. Se\ncorrerá la siguiente línea de comando: gmx gyrate -f traj.xtc -s\ncoor-tpr.pdb -o rg.xvg -b A -e B -> Se deberá escoger sólo la\nproteína. -> Siendo A y B los mismos tiempos (en ps) utilizados en el\npunto 4. Así, esto nos arrojará un archivo de salida rg.xvg el que se\npodrá graficar. Cabe mencionar que se le llama “radio de giro” pues\nluego de calcular la ponderación por masa de cada átomo en el espacio,\ndichos puntos se comparan frame a frame con el centro de masa de toda la\nproteína (a modo de colocar esta proteína dentro de una esfera) y el\n“radio” resultante más alejado del centro es aquel que se asigna en cada\nframe; finalmente, y a groso modo, se obtienen así las dos columnas del\narchivo rg.xvg.\nSASA y energía\nlibre de solvatación estimada\nCon la siguiente línea de comando se calculará tanto el área\nsuperficial accesible al solvente (también conocida como superficie\nmolecular de Lee-Richards) de toda la proteína, como también la energía\nlibre de solvatación estimada como función del tiempo: gmx sasa -f\ntraj.xtc -s coor-tpr.pdb -o sasa.xvg -odg delta-g_solv.xvg -b A -e B\n-> Se deberá escoger sólo la proteína. -> Siendo A y B los mismos\ntiempos (en ps) utilizados en el punto 4. Con los archivos de salida\ngenerados, sasa.xvg y delta-g_solv.xvg, se podrá graficar la superficie\nde Lee-Richards y la energía libre de solvatación estimada (con unidades\nde kJ·mol-1·nm-2), respectivamente, dentro del intervalo de la\ntrayectoria escogido.\nMediciones a lo largo\nde la trayectoria\nExisten diversas formas de realizar mediciones entre átomos, ya sean\ndistancias lineales entre ellos, ángulos o diedros. Para realizar estas\nmediciones es necesario generar un archivo index.ndx con el programa\nmake_ndx, así: gmx make_ndx -f coor-tpr.pdb -o index.ndx -> En el que\nse escogerán átomos o residuos que se desee medir creando así un “grupo\nnuevo” con la selección de dicho elemento. Cabe recordar que serán dos\ngrupos para la medición de distancias, tres grupos para medir ángulos y\ncuatro grupos para la medición de ángulos diedros.\nDistancias\nSi se desea medir la distancia entre dos átomos o dos residuos, estos\núltimos por medio de su centro de masa (com), la línea de comando deberá\nser algo así: gmx distance -f traj.xtc -s coor-tpr.pdb -n index.ndx -oav\ndistance.xvg -select “com of group X plus com of group Y” -b A -e B\n-> Donde X y Y son los grupos (que poseen un elemento cada uno) que\nse desea medir, sean éstos un par de átomos (no habrá problema con que\nse calcule el centro de masa de un átomo, pues serán las mismas\ncoordenadas) o un par de residuos. -> Siendo A y B los mismos tiempos\n(en ps) utilizados en el punto 4. De esta manera se podrá graficar el\narchivo de salida distance.xvg y así conocer la distancia entre éstos\nelementos a lo largo de la trayectoria escogida.\nÁngulos\nPara este caso, la línea de comando sería así: gmx gangle -f traj.xtc\n-n index -g1 angle -oav angles.xvg -group1 “com of group X plus com of\ngroup Y plus com of group Z” -b A -e B -> Donde X, Y y Z son los\ngrupos con los elementos que se desee medir. -> Siendo A y B los\nmismos tiempos (en ps) utilizados en el punto 4. Así, se podrá graficar\nel archivo de salida angles.xvg.\nDiedros\nPara el caso de los diedros la línea de comandos sería algo así: gmx\ngangle -f traj.xtc -n index -g1 dihedral -oav dihedrals.xvg -group1 “com\nof group W plus com of group X plus com of group Y plus com of group Z”\n-b A -e B -> Donde W, X, Y y Z son los grupos que se desee medir.\n-> Siendo A y B los mismos tiempos (en ps) utilizados en el punto 4.\nAsí, se podrá graficar el archivo de salida dihedrals.xvg.\nEstructura secundaria\nPara el cálculo de la estructura secundaria de la proteína en función\ndel tiempo se necesitará realizar la instalación de un pequeño programa\nllamado dssp, el cual se puede hacer del siguiente sitio web: https://swift.cmbi.umcn.nl/gv/dssp. Además, Gromacs\nrequiere que el ejecutable de dicho programa esté localizado en\n/usr/local/bin/dssp. La siguiente línea de comando se utilizará para\nrealizar este cálculo: gmx do_dssp -f traj.xtc -s coor-tpr.pdb -map\nss.map -o ss.xpm -b A -e B -> Donde el archivo de entrada ss.map es\naquel que mapea los datos de una matriz a valores RGB que son utilizados\npor el programa do_dssp. Este archivo debe contener lo siguiente:\n8\n\nCoil 1.0 1.0 1.0 E B-Sheet 1.0 0.0 0.0 B B-Bridge 0.0 0.0 0.0 S Bend 0.0\n0.8 0.8 T Turn 1.0 1.0 0.0 H A-Helix 0.0 0.0 1.0 G 3-Helix 1.0 0.0 1.0 I\n5-Helix 1.0 0.6 0.0\n\nEl archivo de salida ss.xpm generado se podrá convertir a uno de\nimagen por el programa xpm2ps así: gmx xpm2ps -f ss.xpm -di ps.m2p -o\nss.eps -> Donde el archivo de entrada ps.m2p es aquel que le da los\nparámetros (que se pueden modificar) al programa para generar el archivo\nde salida ss.eps. El archivo ps.m2p debe contener lo siguiente:\n; Command line options of xpm2ps override the parameters in this file\nblack&white = no ; Obsolete titlefont = Times-Roman ; A PostScript\nFont titlefontsize = 20 ; Font size (pt) legend = yes ; Show the legend\nlegendfont = Times-Roman ; A PostScript Font legendlabel = ; Used when\nthere is none in the .xpm legend2label = ; Used when merging two xpm’s\nlegendfontsize = 14 ; Font size (pt) xbox = 2.0 ; x-size of a matrix\nelement ybox = 2.0 ; y-size of a matrix element matrixspacing = 20.0 ;\nSpace between 2 matrices xoffset = 0.0 ; Between matrix and bounding box\nyoffset = 0.0 ; Between matrix and bounding box x-major = 20 ; Major\nticks on x axis every .. frames x-minor = 5 ; Id. Minor ticks\nx-firstmajor = 0 ; First frame for major tick x-majorat0 = no ; Major\ntick at first frame x-majorticklen = 8.0 ; x-majorticklength\nx-minorticklen = 4.0 ; x-minorticklength x-label = ; Used when there is\nnone in the .xpm x-fontsize = 16 ; Font size (pt) x-font = Times-Roman ;\nA PostScript Font x-tickfontsize = 10 ; Font size (pt) x-tickfont =\nHelvetica ; A PostScript Font y-major = 20 y-minor = 5 y-firstmajor = 0\ny-majorat0 = no y-majorticklen = 8.0 y-minorticklen = 4.0 y-label =\ny-fontsize = 16 y-font = Times-Roman y-tickfontsize = 10 y-tickfont =\nHelvetica\nDe esta manera, se generará el archivo de imagen ss.eps con las\nestructuras secundarias a color de la proteína a lo largo de la\ntrayectoria (o intervalo escogido con las opciones -b A -e B en la\nprimera línea de comandos).\nPara el caso del cálculo de las siguientes dos propiedades, densidad\ny enlaces de hidrógeno, se requerirá antes generar el archivo de entrada\ntopol.tpr de la siguiente manera: gmx grompp -f grompp.mdp -s\ncoor-tpr.pdb -p topol.top -o topol.tpr -> El archivo de entrada\ngrompp.mdp, para este caso en particular, no requiere de datos\nespecíficos, por lo que bastará con que contenga las siguientes\nlíneas:\n; grompp.mdp - used as input into grompp to generate topol.tpr ;\nParameters describing what to do, when to stop and what to save\nintegrator = steep ; Algorithm (steep = steepest descent minimization)\nemtol = 1000.0 ; Stop minimization when the maximum force < 1000.0\nkJ/mol/nm emstep = 0.01 ; Minimization step size nsteps = 50000 ;\nMaximum number of (minimization) steps to perform\n; Parameters describing how to find the neighbors of each atom and\nhow to calculate the interactions nstlist = 1 ; Frequency to update the\nneighbor list and long range forces cutoff-scheme = Verlet ; Buffered\nneighbor searching ns_type = grid ; Method to determine neighbor list\n(simple, grid) coulombtype = PME ; Treatment of long range electrostatic\ninteractions rcoulomb = 1.0 ; Short-range electrostatic cut-off rvdw =\n1.0 ; Short-range Van der Waals cut-off pbc = xyz ; Periodic Boundary\nConditions in all 3 dimensions\n-> Por otro lado, el archivo de entrada topol.top es indispensable\ny se podrá obtener por medio del servidor https://www.charmm-gui.org/ → “Input generator” → “Force\nField Converter” utilizando los archivos de entrada *psf y *crd\nextraídos de la MD. Luego, se deberá marcar la opción “Gromacs” (al\nllegar al apartado “Input Generation Options”). Finalmente, luego de\ndescargar los archivos generados comprimidos (*.tgz) y dentro de la\ncarpeta “Gromacs” se encontrará el archivo de topología que requerimos.\nDe esta manera obtendremos el archivo topol.top necesario para los\nsiguientes cálculos. Cabe mencionar que este archivo requiere también de\nlos archivos generados de extensión itp que se encuentran dentro de la\ncarpeta toppar.\nDensidad\nRespecto a este parámetro, a veces se requiere conocer la densidad de\ntodo el sistema o de alguna de las partes del mismo (sobre todo en el\ncaso de simulación de proteínas con membranas lipídicas), por lo que\npara tal motivo se utilizará la siguiente línea de comando: gmx density\n-f traj.xtc -s topol.tpr -o density.xvg -b A -e B -> Aquí\nutilizaremos el archivo de entrada recientemente generado topol.tpr El\nresultado será el archivo de salida density.xvg el que contiene la\ninformación de la densidad a lo largo de la trayectoria escogida.\nEnlaces de hidrógeno\nSe podrá calcular la cantidad de enlaces como función del tiempo\nutilizando la siguiente línea de comando: gmx hbond -f traj.xtc -s\ntopol.tpr -num hbnum.xvg -dist hbdist.xvg -ang hbang.xvg -dan danum.xvg\n-b A -e B -> Aquí utilizaremos el archivo de entrada recientemente\ngenerado topol.tpr -> El archivo de salida hbnum.xvg contendrá el\nnúmero total de enlaces de hidrógeno por frame a lo largo de la\ntrayectoria escogida. -> Los archivos de salida hbdist.xvg y\nhbang.xvg contendrán la distribución de la distancia y de los ángulos,\nrespectivamente, para todos los enlaces de hidrógeno. -> El archivo\nde salida danum.xvg contendrá el número de dadores y aceptores\nanalizados en cada frame de la trayectoria escogida. De esta manera se\npodrán graficar los archivos xvg relacionados con el cálculo de los\nenlaces de hidrógeno.\nFinalmente, cabe mencionar que se puede utilizar el programa make_ndx\npara seleccionar diversos átomos, residuos o incluso una mezcla entre\néstos y generar grupos que se guardarán en el archivo de salida\nindex.ndx, el que se podrá utilizar en todos los análisis vistos en el\npresente tutorial, en el caso que así lo requiramos, adicionando a la\nlínea de comandos lo siguiente: -n index.ndx.\nSecond level header\nMore text. More text. More text. More text. More text. More text.\nMore text. More text. More text. More text. More text.\nFirst thing.\nSecond.\nThird.\nbullet one\ntwo\nthree\nInsert links like this https://github.com/camilofm/Blog_of_Camilo.\nOr like this my\nwebsite.\nWhat's this? or this? or\nthis?\nCite papers\nI could cite like this (fremont_biological_2000?).\nAnd also here (walle_bioavailability_2011?).\n\n\n\n",
    "preview": "posts/tutorial_gromacs/pictures/gromacs.png",
    "last_modified": "2022-10-02T20:17:57-05:00",
    "input_file": "tutorial_gromacs.knit.md"
  }
]
