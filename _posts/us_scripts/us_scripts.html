<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>Scripts en Bash para realizar cálculos Umbrella Sampling (QM/MM MD)</title>

  <meta property="description" itemprop="description" content="En este post presento dos scripts que sirven para generar los archivos de entrada para poder correr cálculos de Umbrella Sampling en sistemas proteína-ligando y utilizando la interfaz CHARMM-Gaussian, dado que el nivel de teoría a utilizar será SCC-DFTB/CHARMM."/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2022-09-20"/>
  <meta property="article:created" itemprop="dateCreated" content="2022-09-20"/>
  <meta name="article:author" content="Camilo Febres-Molina"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Scripts en Bash para realizar cálculos Umbrella Sampling (QM/MM MD)"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="En este post presento dos scripts que sirven para generar los archivos de entrada para poder correr cálculos de Umbrella Sampling en sistemas proteína-ligando y utilizando la interfaz CHARMM-Gaussian, dado que el nivel de teoría a utilizar será SCC-DFTB/CHARMM."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Scripts en Bash para realizar cálculos Umbrella Sampling (QM/MM MD)"/>
  <meta property="twitter:description" content="En este post presento dos scripts que sirven para generar los archivos de entrada para poder correr cálculos de Umbrella Sampling en sistemas proteína-ligando y utilizando la interfaz CHARMM-Gaussian, dado que el nivel de teoría a utilizar será SCC-DFTB/CHARMM."/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","output"]}},"value":[{"type":"character","attributes":{},"value":["Scripts en Bash para realizar cálculos Umbrella Sampling (QM/MM MD)"]},{"type":"character","attributes":{},"value":["En este post presento dos scripts que sirven para generar los archivos de entrada para poder correr cálculos de Umbrella Sampling en sistemas proteína-ligando y utilizando la interfaz CHARMM-Gaussian, dado que el nivel de teoría a utilizar será SCC-DFTB/CHARMM.\n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url","affiliation","affiliation_url"]}},"value":[{"type":"character","attributes":{},"value":["Camilo Febres-Molina"]},{"type":"character","attributes":{},"value":["https://github.com/camilofm"]},{"type":"character","attributes":{},"value":["Doctorado en Fisicoquímica Molecular - UNAB - Chile"]},{"type":"character","attributes":{},"value":["https://investigacion.unab.cl/doctorados/doctorado-en-fisicoquimica-molecular/"]}]}]},{"type":"character","attributes":{},"value":["09-20-2022"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[false]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["pictures/code.png","pictures/neg_win.png","pictures/result.png","pictures/traj_neg.png","scripts_files/0_old.inp","scripts_files/01-create_conf-cfm.sh","scripts_files/02-create_us_eq-cfm.sh","scripts_files/1.sh","scripts_files/2.sh","scripts_files/conf_template.inp","scripts_files/extract.inp","scripts_files/makenew_cns.inp","scripts_files/makenew_reg.inp","scripts_files/negative_rc.txt","scripts_files/positive_rc.txt","scripts_files/prueba.sh","scripts_files/traj_frames_neg.txt","scripts_files/traj_frames_pos.txt","scripts_files/us_eq_template.inp","us_scripts_files/anchor-4.2.2/anchor.min.js","us_scripts_files/bowser-1.9.3/bowser.min.js","us_scripts_files/distill-2.2.21/template.v2.js","us_scripts_files/header-attrs-2.16/header-attrs.js","us_scripts_files/jquery-3.6.0/jquery-3.6.0.js","us_scripts_files/jquery-3.6.0/jquery-3.6.0.min.js","us_scripts_files/jquery-3.6.0/jquery-3.6.0.min.map","us_scripts_files/popper-2.6.0/popper.min.js","us_scripts_files/tippy-6.2.7/tippy-bundle.umd.min.js","us_scripts_files/tippy-6.2.7/tippy-light-border.css","us_scripts_files/tippy-6.2.7/tippy.css","us_scripts_files/tippy-6.2.7/tippy.umd.min.js","us_scripts_files/webcomponents-2.0.0/webcomponents.js"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        if ($(this).children()[0].nodeName == "D-FOOTNOTE") {
          var fn = $(this).children()[0]
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          return "<p>" + $('#ref-' + ref).html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="us_scripts_files/header-attrs-2.16/header-attrs.js"></script>
  <script src="us_scripts_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="us_scripts_files/popper-2.6.0/popper.min.js"></script>
  <link href="us_scripts_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="us_scripts_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="us_scripts_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="us_scripts_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="us_scripts_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="us_scripts_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="us_scripts_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Scripts en Bash para realizar cálculos Umbrella Sampling (QM/MM MD)","description":"En este post presento dos scripts que sirven para generar los archivos de entrada para poder correr cálculos de Umbrella Sampling en sistemas proteína-ligando y utilizando la interfaz CHARMM-Gaussian, dado que el nivel de teoría a utilizar será SCC-DFTB/CHARMM.","authors":[{"author":"Camilo Febres-Molina","authorURL":"https://github.com/camilofm","affiliation":"Doctorado en Fisicoquímica Molecular - UNAB - Chile","affiliationURL":"https://investigacion.unab.cl/doctorados/doctorado-en-fisicoquimica-molecular/","orcidID":""}],"publishedDate":"2022-09-20T00:00:00.000-05:00","citationText":"Febres-Molina, 2022"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Scripts en Bash para realizar cálculos Umbrella Sampling (QM/MM MD)</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>En este post presento dos scripts que sirven para generar los
archivos de entrada para poder correr cálculos de Umbrella Sampling en
sistemas proteína-ligando y utilizando la interfaz CHARMM-Gaussian, dado
que el nivel de teoría a utilizar será SCC-DFTB/CHARMM.</p></p>
</div>

<div class="d-byline">
  Camilo Febres-Molina <a href="https://github.com/camilofm"
class="uri">https://github.com/camilofm</a> (Doctorado en Fisicoquímica
Molecular - UNAB - Chile)<a
href="https://investigacion.unab.cl/doctorados/doctorado-en-fisicoquimica-molecular/"
class="uri">https://investigacion.unab.cl/doctorados/doctorado-en-fisicoquimica-molecular/</a>
  
<br/>09-20-2022
</div>

<div class="d-article">
<style>
body {
text-align: justify}
</style>
<div class="layout-chunk" data-layout="l-body">
<p><img src="pictures/code.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<h1 id="indicaciones-iniciales">Indicaciones iniciales</h1>
<p>Los siguientes dos scripts en Bash requieren de otros archivos en los
que les proporcionaremos las ventanas de simulación, los frames que
corresponden a dichas ventanas de simulación, los archivos ‘input’
plantilla para enviar los cálculos a CHARMM, y finalmente, los archivos
‘input’ que generarán otros archivos necesarios para las dinámicas
QM/MM.</p>
<p>Por lo tanto, los archivos que deben estar en la misma dirección para
lograr generar satisfactoriamente las carpetas con los archivos de
entrada correspondientes a cada una de las ventanas negativas y
positivas son los siguientes:</p>
<ul>
<li><p>01-create_conf-cfm.sh;       &lt;– <em>Los scripts</em></p></li>
<li><p>02-create_us_eq-cfm.sh;</p></li>
<li><p>negative_rc.txt;                     &lt;– <em>Y los archivos
extras</em></p></li>
<li><p>positive_rc.txt;</p></li>
<li><p>traj_frames_neg.txt;</p></li>
<li><p>traj_frames_pos.txt</p></li>
<li><p>conf_template.inp;</p></li>
<li><p>us_eq_template.inp;</p></li>
<li><p>makenew_cns.inp;</p></li>
<li><p>makenew_reg.inp;</p></li>
</ul>
<h1 id="scripts-y-archivos-extra">Scripts y archivos extra</h1>
<p>01-create_conf-cfm.sh:</p>
<pre><code>#!/bin/bash

### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ###
###                                                             ###
###   This script creates configure files for PMF calculation   ###
###        Run this script before 02-create_us_eq-cfm.sh        ###
###       Needs the following things in the same directory:     ###
###               negative_rc.txt, traj_frames_*.txt,           ###
###                conf_template.inp, makenew_*inp,             ###
###                        positive_rc.txt                      ###
###        (Remember to address the .crd, .psf, .dcd &amp;          ###
###         parameters files in the conf_template file)         ###
###   Note: There is a part (mentioned below) that must be      ###
###         adapted to the number of RC &amp; trajectory frames     ###
###         of your system.                                     ###
###   by CFM                                                    ###

### First part: negative RC ###  

#creating negative RC directories &amp; conf_nX.inp files within
cat negative_rc.txt | while read rc
do
   mkdir n$rc
   echo &quot;n$rc directory created ...&quot;
   sed -e &quot;s|RRR|n$rc|g&quot; conf_template.inp &gt; n$rc/conf_n$rc.inp # changes input &amp; output
   echo &quot;n$rc/conf_n$rc.inp file created ...&quot;
done

#generating a temporary file &#39;rc_tr-neg.txt&#39; to use each number later
cat negative_rc.txt &gt;&gt; rc_tr-neg.txt
cat traj_frames_neg.txt &gt;&gt; rc_tr-neg.txt
echo &quot;rc_tr-neg.txt temporary file created ...&quot;

#!!! This part must be adapted to the number of RC &amp; trajectory frames of your system !!!#
#reading RC
read rc1 &lt; &lt;(sed -n 1p rc_tr-neg.txt)
read rc2 &lt; &lt;(sed -n 2p rc_tr-neg.txt)
read rc3 &lt; &lt;(sed -n 3p rc_tr-neg.txt)
read rc4 &lt; &lt;(sed -n 4p rc_tr-neg.txt)
read rc5 &lt; &lt;(sed -n 5p rc_tr-neg.txt)
read rc6 &lt; &lt;(sed -n 6p rc_tr-neg.txt)
read rc7 &lt; &lt;(sed -n 7p rc_tr-neg.txt)
read rc8 &lt; &lt;(sed -n 8p rc_tr-neg.txt)

#reading trajectory frames
read fr1 &lt; &lt;(sed -n 9p rc_tr-neg.txt)
read fr2 &lt; &lt;(sed -n 10p rc_tr-neg.txt)
read fr3 &lt; &lt;(sed -n 11p rc_tr-neg.txt)
read fr4 &lt; &lt;(sed -n 12p rc_tr-neg.txt)
read fr5 &lt; &lt;(sed -n 13p rc_tr-neg.txt)
read fr6 &lt; &lt;(sed -n 14p rc_tr-neg.txt)
read fr7 &lt; &lt;(sed -n 15p rc_tr-neg.txt)
read fr8 &lt; &lt;(sed -n 16p rc_tr-neg.txt)

#correlating each frame of trajectory with its appropriate RC conf file
sed -i &quot;s|TTT|$fr1|g&quot; n$rc1/conf_n$rc1.inp
echo &quot;n$rc1/conf_n$rc1.inp file correctly correlated ...&quot;
sed -i &quot;s|TTT|$fr2|g&quot; n$rc2/conf_n$rc2.inp
echo &quot;n$rc2/conf_n$rc2.inp file correctly correlated ...&quot;
sed -i &quot;s|TTT|$fr3|g&quot; n$rc3/conf_n$rc3.inp
echo &quot;n$rc3/conf_n$rc3.inp file correctly correlated ...&quot;
sed -i &quot;s|TTT|$fr4|g&quot; n$rc4/conf_n$rc4.inp
echo &quot;n$rc4/conf_n$rc4.inp file correctly correlated ...&quot;
sed -i &quot;s|TTT|$fr5|g&quot; n$rc5/conf_n$rc5.inp
echo &quot;n$rc5/conf_n$rc5.inp file correctly correlated ...&quot;
sed -i &quot;s|TTT|$fr6|g&quot; n$rc6/conf_n$rc6.inp
echo &quot;n$rc6/conf_n$rc6.inp file correctly correlated ...&quot;
sed -i &quot;s|TTT|$fr7|g&quot; n$rc7/conf_n$rc7.inp
echo &quot;n$rc7/conf_n$rc7.inp file correctly correlated ...&quot;
sed -i &quot;s|TTT|$fr8|g&quot; n$rc8/conf_n$rc8.inp
echo &quot;n$rc8/conf_n$rc8.inp file correctly correlated ...&quot;

rm rc_tr-neg.txt
#!!! !!! !!! !!! !!! !!! !!! !!! !!! !!!  !!! !!! !!! !!! !!! !!! !!! !!! !!! !!! !!! !!!#

#copying some relevant files down to the nRC directories &amp; executing the conf file
cat negative_rc.txt | while read rc
do
   cp makenew_*inp n$rc/
   cp -r toppar* n$rc/ #copying parameters file &amp; directory for the protein
   cp -r 7kp/ n$rc/ #copying parameters directory for the ligand
   echo &quot;Relevant files copied down to n$rc/ directory ...&quot;
   echo &quot;Executing n$rc/conf_n$rc.inp file in charmm...&quot;
   cd n$rc
   /opt/charmm-45b2/exec/gnu_M/charmm &lt; conf_n$rc.inp &gt; conf_n$rc.out
   cd ..
done

###   Second part: positive RC ###

#creating positive RC directories &amp; conf_pX.inp files within
cat positive_rc.txt | while read rc
do
   mkdir p$rc
   echo &quot;p$rc directory created ...&quot;
   sed -e &quot;s|RRR|p$rc|g&quot; conf_template.inp &gt; p$rc/conf_p$rc.inp # changes input &amp; output
   echo &quot;p$rc/conf_p$rc.inp file created ...&quot;
done

#generating a temporary file &#39;rc_tr-pos.txt&#39; to use each number later
cat positive_rc.txt &gt;&gt; rc_tr-pos.txt
cat traj_frames_pos.txt &gt;&gt; rc_tr-pos.txt
echo &quot;rc_tr-pos.txt temporary file created ...&quot;

#!!! This part must be adapted to the number of RC &amp; trajectory frames of your system !!!#
#reading RC
read rc1 &lt; &lt;(sed -n 1p rc_tr-pos.txt)
read rc2 &lt; &lt;(sed -n 2p rc_tr-pos.txt)
read rc3 &lt; &lt;(sed -n 3p rc_tr-pos.txt)
read rc4 &lt; &lt;(sed -n 4p rc_tr-pos.txt)
read rc5 &lt; &lt;(sed -n 5p rc_tr-pos.txt)
read rc6 &lt; &lt;(sed -n 6p rc_tr-pos.txt)
read rc7 &lt; &lt;(sed -n 7p rc_tr-pos.txt)
read rc8 &lt; &lt;(sed -n 8p rc_tr-pos.txt)

#reading trajectory frames
read fr1 &lt; &lt;(sed -n 9p rc_tr-pos.txt)
read fr2 &lt; &lt;(sed -n 10p rc_tr-pos.txt)
read fr3 &lt; &lt;(sed -n 11p rc_tr-pos.txt)
read fr4 &lt; &lt;(sed -n 12p rc_tr-pos.txt)
read fr5 &lt; &lt;(sed -n 13p rc_tr-pos.txt)
read fr6 &lt; &lt;(sed -n 14p rc_tr-pos.txt)
read fr7 &lt; &lt;(sed -n 15p rc_tr-pos.txt)
read fr8 &lt; &lt;(sed -n 16p rc_tr-pos.txt)

#correlating each frame of trajectory with its appropriate RC conf file
sed -i &quot;s|TTT|$fr1|g&quot; p$rc1/conf_p$rc1.inp
echo &quot;p$rc1/conf_p$rc1.inp file correctly correlated ...&quot;
sed -i &quot;s|TTT|$fr2|g&quot; p$rc2/conf_p$rc2.inp
echo &quot;p$rc2/conf_p$rc2.inp file correctly correlated ...&quot;
sed -i &quot;s|TTT|$fr3|g&quot; p$rc3/conf_p$rc3.inp
echo &quot;p$rc3/conf_p$rc3.inp file correctly correlated ...&quot;
sed -i &quot;s|TTT|$fr4|g&quot; p$rc4/conf_p$rc4.inp
echo &quot;p$rc4/conf_p$rc4.inp file correctly correlated ...&quot;
sed -i &quot;s|TTT|$fr5|g&quot; p$rc5/conf_p$rc5.inp
echo &quot;p$rc5/conf_p$rc5.inp file correctly correlated ...&quot;
sed -i &quot;s|TTT|$fr6|g&quot; p$rc6/conf_p$rc6.inp
echo &quot;p$rc6/conf_p$rc6.inp file correctly correlated ...&quot;
sed -i &quot;s|TTT|$fr7|g&quot; p$rc7/conf_p$rc7.inp
echo &quot;p$rc7/conf_p$rc7.inp file correctly correlated ...&quot;
sed -i &quot;s|TTT|$fr8|g&quot; p$rc8/conf_p$rc8.inp
echo &quot;p$rc8/conf_p$rc8.inp file correctly correlated ...&quot;

rm rc_tr-pos.txt
#!!! !!! !!! !!! !!! !!! !!! !!! !!! !!!  !!! !!! !!! !!! !!! !!! !!! !!! !!! !!! !!! !!!#

#copying some relevant files down to the pRC directories &amp; executing the conf file
cat positive_rc.txt | while read rc
do
   cp makenew_*inp p$rc/
   cp -r toppar* p$rc/ #copying parameters file &amp; directory for the protein
   cp -r 7kp/ p$rc/ #copying parameters directory for the ligand
   echo &quot;Relevant files copied down to p$rc/ directory ...&quot;
   echo &quot;Executing p$rc/conf_p$rc.inp file in charmm...&quot;
   cd p$rc
   /opt/charmm-45b2/exec/gnu_M/charmm &lt; conf_p$rc.inp &gt; conf_p$rc.out
   cd ..
done

echo &quot;Done.&quot;

###                                                             ###
###                       End of this script                    ###
###                                                             ###
### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ###</code></pre>
<p>02-create_us_eq-cfm.sh:</p>
<pre><code>#!/bin/bash

### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ###
###                                                             ###
###  This script creates equilibration files for US - QM/MM MD  ###
###             Run this after 01-create_conf-cfm.sh            ###
###            Additionally needs the following files           ###
###                      in the same directory:                 ###
###                 us_eq_template.inp, sccdftb.dat             ###
###          (Remember to define your qm zone, charge &amp;         ###
###         other parameters in the us_eq_template file)        ###
###   by CFM                                                    ###

### First part: negative RC ###  

#creating the eq_nX.inp file &amp; copying sccdftb.dat file
cat negative_rc.txt | while read rc
do
   d1=`echo $rc | cut -b 1`
   d2=`echo $rc | cut -b 2`
   sed -e &quot;s|TTT|-$d1.$d2|g&quot; us_eq_template.inp &gt; n$rc/eq_n$rc.inp   #putting the RC
   sed -i &quot;s|RRR|n$rc|g&quot; n$rc/eq_n$rc.inp   #changing the input &amp; output
   echo &quot;n$rc/eq_n$rc.inp file created ...&quot;
   cp sccdftb.dat n$rc
done

### Second part: positive RC ###

#creating the eq_pX.inp file &amp; copying sccdftb.dat file
cat positive_rc.txt | while read rc
do
   d1=`echo $rc | cut -b 1`
   d2=`echo $rc | cut -b 2`
   sed -e &quot;s|TTT|$d1.$d2|g&quot; us_eq_template.inp &gt; p$rc/eq_p$rc.inp   #putting the RC
   sed -i &quot;s|RRR|p$rc|g&quot; p$rc/eq_p$rc.inp   #changing the input &amp; output
   echo &quot;p$rc/eq_p$rc.inp file created ...&quot;
   cp sccdftb.dat p$rc
done

echo &quot;Done.&quot;

###                                                             ###
###                       End of this script                    ###
###                                                             ###
### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ###</code></pre>
<p>A continuación se muestran ejemplos arbitrarios de los archivos extra
arriba mencionados:</p>
<ul>
<li>negative_rc.txt:</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<p><img src="pictures/neg_win.png" width="30%" style="display: block; margin: auto;" /></p>
</div>
<ul>
<li>traj_frames_neg.txt:</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<p><img src="pictures/traj_neg.png" width="30%" style="display: block; margin: auto;" /></p>
</div>
<ul>
<li>conf_template.inp:</li>
</ul>
<pre><code>!Configuracion para crear esfera con zonas definidas, para hacer umbrella sampling - example

bomlev -1
set d .
set stream ~/utils/stream
set input RRR
set output RRR

stream toppar_wo.str

open read form unit 1 name ~/umbrella/gtfwt_cryst.psf
READ psf card unit 1
close unit 1

open read form unit 1 name ~/umbrella/prod.crd
READ coord card unit 1
close unit 1

! .1define the substrate stereocenter as the origin of coordinates
define cntr1 sele segid HETA .and. type C1 end

! .2moving
coor stat sele cntr1 end
coor translate xdir -?xave ydir -?yave zdir -?zave sele all end

! .3checking center
coor stat sele cntr1 end

open read unit 3 file name ~/umbrella/path.dcd
read coord file unit 3 ifile TTT
close unit 3

dele atom sele .byres. ( .not. ( point 0.0 0.0 0.0 cut 30.0)) end

!-----------regions
set xcen     0.0
set ycen     0.0
set zcen     0.0
set rsphere 25.0         ! radius of the spherical region of interest
set rexcl    2.0         ! water exclusion radius
set rgeo     4.0         ! to setup the MMFP potential
calc rwater  = @rsphere - @rexcl
calc rdroff  = @rsphere - @rgeo
set temp   310.0 !for lang region

stream @stream/writeall.inp
stream @stream/input.inp
stream makenew_reg.inp
stream makenew_cns.inp  

end</code></pre>
<ul>
<li>us_eq_template.inp:</li>
</ul>
<pre><code>! Equilibrium MD for umbrella sampling - example

bomlev -2
!----files
set input RRR
set output RRR
set loadcrd  0 !load @restart.crd before any min or md
set loadres  0 !load @restart.res before any min or md
set loadpdb  0 !load @restart.res before any min or md
!set mijinp   1v54.fsph30.mij.25.mij
!set phiinp   1v54.fsph30.phi
!----directories
set d .
set stream ~/utils/stream

!-----keywords
set kumb 100.0
set del0 TTT
!-----------elec options
set nbond ext
!set nbond atcut
!set polgsbp 25
!-----------min op
set minon  0
set minrun abnr
set minstep 50
set minprint 1
set mintolg 0.01
!-----------md op
set mdon  1
set mdrun  start
!set mdseed 314159
set mdtype lang
set timest 0.001
set mdstep 10000
set mdfirst 100
set mdtemp 310
set ieqfrq 500.0 !higher than 0.0 for equilibration
!
!-----------regions (consistens with regions/constants file)
set xcen     0.0
set ycen     0.0
set zcen     0.0
set rsphere 25.0         ! radius of the spherical region of interest
set rexcl    2.0         ! water exclusion radius 
set rgeo     4.0         ! to setup the MMFP potential + Langevin(buffer) zone
calc rwater  = @rsphere - @rexcl
calc rdroff  = @rsphere - @rgeo

stream toppar_wo.str

stream @stream/input.inp

stream @stream/nbond_atcut.inp
!set langevin environment
stream @stream/sbc.inp
!what is fixed and what moves (consistent with sbc)
! apply regdef and mmfp altogether
stream @stream/regdef.inp !fix(3-bonds rule) and scale 0.0 charges
!cons fix sele resname CU2 end ! CUa is very close to the edge we dont have parameter
stream @stream/mmfp_sph.inp

define asp sele segid PROA .and. resid 477 .and.( .not. (type CA .or. type HA -
 .or. type N .or. type HN .or. type C .or. type O )) end

define glup sele segid PROA .and. resid 515 .and.( .not. (type CA .or. type HA - 
 .or. type N .or. type HN .or. type C .or. type O )) end

define asp2 sele segid PROA .and. resid 588 .and.( .not. (type CA .or. type HA -
 .or. type N .or. type HN .or. type C .or. type O )) end

define wo67 sele segid HETB .and. resid 1167 end

define wo96 sele segid HETB .and. resid 1196 end

define qm sele asp .or. glup .or. segid HETA .or. asp2 .or. wo67 .or. wo96 end

scalar WMAIN set 1.0 sele (qm) .and. type O*  SHOW end
scalar WMAIN set 2.0 sele (qm) .and. type N*  SHOW end
scalar WMAIN set 3.0 sele (qm) .and. type C*  SHOW end
scalar WMAIN set 4.0 sele (qm) .and. type H*  SHOW end
scalar WMAIN set 4.0 sele (qm) .and. type QQ*  SHOW end

SCCDFTB remove CHRG -2 SELE QM END TEMP 0.00 SCFT 0.00000001  D3RD HBOND

!------Load current geom--
if loadcrd lt 1 goto noloadcrd
open read unit 3 card name @d/@restart.crd
read coor card unit 3
close unit 3

label noloadcrd
!------Load current geom--
if loadres lt 1 goto noloadres
open read unit 3 card name @d/@restart.res
read coor dynr curr unit 3
close unit 3

label noloadres
!------Load current geom--
if loadpdb lt 1 goto noloadpdb
open read unit 3 card name @d/@restart.pdb
read coor pdb unit 3
close unit 3

label noloadpdb

open write unit 3 card name @output.qm.pdb
write coor pdb sele qm end unit 3
close unit 3

rxncor: define o1   point sele atom HETA 1 O1 end
rxncor: define c1   point sele atom HETA 1 C1 end
rxncor: define oasp point sele atom PROA 477 OD1 end
rxncor: define a3   dist o1 c1
rxncor: define a4   dist c1 oasp

rxncor: define RC combin a3 1.0 a4 -1.0
rxncor: set nrxn 1 RC

open unit 29 form write name  @d/@output.rc

rxncor: trace RC unit 29

rxncor: umbrella name RC kumb @kumb del0 @del0 form 1 
rxncor: statistics name RC lowdelta -1.7 hidelta 1.5 deldel 0.1 start 1000
!energy
!-------MIN -------------
if minon lt 1 goto nomin
!open write unit 11 uform name @output.min.dcd
!mini @minrun nstep @minstep nprint @minprint tolg @mintolg iuncrd 11 nsavc 3
mini @minrun nstep @minstep nprint @minprint tolg @mintolg

label nomin

if mdon lt 1 goto nomd
!shake bonh tolerance 1.0e-06 MXIT 1500

open unit 24 form read  name @d/@restart.res
open unit 25 form write name @d/@output.res
open unit 26 file write name @d/@output.dcd
open unit 21 form write name @d/@output.static 

dynamics @mdtype @mdrun timestep @timest nstep @mdstep nprint 10 iprfrq 500 -
    firstt @mdfirst finalt @mdtemp tstruc @mdtemp TEMINC 5.0 twindl -10.0 twindh 10.0 -
    IHTFRQ 0 IEQFRQ @ieqfrq NTRFRQ 0 ISVFRQ 100 -
    IASORS 0 IASVEL 1 ISCVEL 0 ICHECW 0 ISEED iseed -
    iunrea 24 iunwri 25 iuncrd 26 iunvel -1 kunit 20 nsavc 100 nsavv 0 -
    inbfrq -1 imgfrq 0 ilbfrq -1 ihbfrq 0 tbath @mdtemp rbuffer @rdroff

rxncor: write unit 21
close unit 21
close unit 25
close unit 26

label nomd

open write unit 3 card name qm.@output.pdb
write coor pdb sele qm end unit 3
close unit 3

stream @stream/write.inp

stop</code></pre>
<ul>
<li>makenew_cns.inp</li>
</ul>
<pre><code>* constraints
*
OPEN UNIT 3 NAME @d/@input.reg READ FORM
READ  COOR COMP CARD UNIT 3
CLOSE UNIT 3


! atoms beyond 18A will be held fixed, so only need to add constraints to
! buffer region atoms within that cutoff
!set 1 20.0    ! radius for fully mobile region
!set 2 24.0    ! radius of inner region
!set 3 22.0    ! radius of buffer region where Langevin dynamics will be used

! Setting various boundary flags
scalar xcomp store 1    ! initial md region
scalar ycomp store 2    ! initial buffer region
scalar zcomp store 3    ! initial Langevin atoms-proteins only
scalar wcomp store 4    ! reservoir region atoms

! Convert crystallographic thermal factors in wmain to constraint forces
scalar wmain reci sele recall 3 end               ! get 1/B
scalar wmain mult 0.001987191 sele recall 3 end   ! k(boltz)/B
scalar wmain mult @temp sele recall 3 end         ! kT/B
scalar wmain mult 4.0 sele recall 3 end           ! 4kT/B
scalar wmain mult 9.87 sele recall 3 end          ! 4(pi**2)kT/B
scalar wmain set 0.0 sele .not. recall 3 end      ! zero out the rest
scalar wmain store 5

scalar xcomp set 0.0 sele all end
scalar ycomp set 0.0 sele all end
scalar zcomp set 0.0 sele all end
scalar wcomp set 0.0 sele all end

scalar xcomp recall 3                    ! langevin region constraint flags
scalar zcomp set 1.0 sele recall 3 .or. (resn TIP3 .and. type OH2) end
scalar zcomp mult 80.0 sele recall 3 end                     ! protein friction
scalar zcomp mult 80.0 sele (resn TIP3 .and. type OH2) end   ! TIP3 friction
scalar ycomp recall 5                    ! unscaled constraint force constants
scalar wcomp recall 1

open unit 15 write form name  @d/@output.cnu
write coor comp card unit 15
* col. 1: langevin region constraint flags
* col. 2: UNSCALED langevin region harmonic constraint forces
* col. 3: langevin friction coefficients.
* col. 4: MD region flags.
*
! ****** Scale the constraints based on where the atoms are ******
! Values of S(r) for scaling the constraint forces

set 4 0.00 !inner langevin region
set 5 0.08 !next
set 6 0.20 !next
set 7 0.32 !next
set 8 0.44 !next
set 9 0.50 !next

!calc zones for scaling
calc lang = @rsphere - @rdroff
calc lang4 = @rdroff 
calc lang5 = @rdroff + 0.5
calc lang6 = @rdroff + 1.0
calc lang7 = @rdroff + 1.5
calc lang8 = @rdroff + 2.0

!force constant scaling
scalar xcomp store 1
scalar ycomp mult @4 sele ( recall 1 .and. point @xcen @ycen @zcen cut @lang4 ) end
scalar ycomp mult @5 sele ( recall 1 .and. point @xcen @ycen @zcen cut @lang5 -
                            .and. .not. point @xcen @ycen @zcen cut @lang4 ) end
scalar ycomp mult @6 sele ( recall 1 .and. point @xcen @ycen @zcen cut @lang6 -
                            .and. .not. point @xcen @ycen @zcen cut @lang5 ) end
scalar ycomp mult @7 sele ( recall 1 .and. point @xcen @ycen @zcen cut @lang7 -
                            .and. .not. point @xcen @ycen @zcen cut @lang6 ) end
scalar ycomp mult @8 sele ( recall 1 .and. point @xcen @ycen @zcen cut @lang8 -
                            .and. .not. point @xcen @ycen @zcen cut @lang7 ) end
scalar ycomp mult @9 sele ( recall 1 .and. .not. point @xcen @ycen @zcen cut @lang8 ) end

!friction scaling
scalar zcomp mult @4 sele (recall 1 .and. point @xcen @ycen @zcen cut @lang4 -
       .and. .not. resn TIP3) end
scalar zcomp mult @5 sele (recall 1 .and. point @xcen @ycen @zcen cut @lang5 -
       .and. .not. (point @xcen @ycen @zcen cut @lang4 .or. resn TIP3)) end
scalar zcomp mult @6 sele (recall 1 .and. point @xcen @ycen @zcen cut @lang6 -
       .and. .not. (point @xcen @ycen @zcen cut @lang5 .or. resn TIP3)) end
scalar zcomp mult @7 sele (recall 1 .and. point @xcen @ycen @zcen cut @lang7 -
       .and. .not. (point @xcen @ycen @zcen cut @lang6 .or. resn TIP3)) end
scalar zcomp mult @8 sele (recall 1 .and. point @xcen @ycen @zcen cut @lang8 -
       .and. .not. (point @xcen @ycen @zcen cut @lang7 .or. resn TIP3)) end
scalar zcomp mult @9 sele (recall 1 .and. .not. -
       (point @xcen @ycen @zcen cut @lang8 .or. resn TIP3)) end

open unit 14 write form name @d/@output.cns
write coor comp card unit 14
* col. 1: langevin region constraint flags
* col. 2: SCALED langevin region harmonic constraint forces
* col. 3: SCALED langevin friction coefficients.
* col. 4: MD region flags.

stop</code></pre>
<ul>
<li>makenew_reg.inp</li>
</ul>
<pre><code>* center at Cu
*
! atoms beyond ? will be held fixed, so only need to add constraints to
! buffer region atoms within that cutoff
!set 1 20.0    ! radius for fully mobile region
!set 2 24.0    ! radius of inner region
!set 3 22.0    ! radius of buffer region where Langevin dynamics will be used
!set 1 @rdroff    ! radius for fully mobile region
!set 2 @rsphere   ! radius of inner region
!set 3 @rwater    ! radius of buffer region where Langevin dynamics will be used

!all comments were written in a 24/22/20 partition. but the input is general

scalar xcomp set 0.0
scalar ycomp set 0.0
scalar zcomp set 0.0
scalar wcomp set 0.0

! INNER, MOBILE REGION
! residues with at least one atom within 20-A and
!   with no main chain atoms outside of 22-A
scalar xcomp set 1.0 -
         sele  ( .byres. ( point @xcen @ycen @zcen cut @rdroff ) ) -
        .and. .not. (( type C  .or. type O  .or. type N .or. -
                      type CA .or. type HA .or. type HN) -
        .and. .not. ( point @xcen @ycen @zcen cut @rwater )) end
scalar xcomp store 1

! INITIAL BUFFER REGION
! residues with at least one atom within 24-A,  but not already
!  included in the inner, mobile region
scalar ycomp set 1.0 sele ( .byres. ( point @xcen @ycen @zcen cut @rsphere ) ) -
        .and. .not. recall 1 end
scalar ycomp store 2

! PROTEIN LANGEVIN ATOMS
! all atoms, except hydrogens and waters in the buffer region
scalar zcomp set 1.0 sele recall 2 .and. .not. -
        ( hydrogen .or. lone .or. resname tip3 ) end
scalar zcomp store 3

! OUTER REGION ATOMS
! any atom not in the inner or buffer regions
scalar wcomp set 1.0 sele .not. (recall 1 .or. recall 2 ) end
scalar wcomp store 4
!write out the new psf and crd, as well as partition.

open unit 13 write form name @d/@output.reg
write coor card comp unit 13
* column 1: reaction region 16 A by residue partioning
* column 2: Buffer region atoms, any atoms (byres) within @rsphere A but
*           not in @rdroff A plus all main chain atoms outside @rwater A
* column 3: Protein Langevin atoms (same as col. 2 but no H or tip3).
* column 4: Outer region atoms
*

return</code></pre>
<p>Finalmente, cabe destacar dos cosas:</p>
<ul>
<li><p>Se debe recordar direccionar correctamente los archivos de
coordenadas (.crd), de topología (.psf), trayectoria (.dcd) y los
parámetros en el archivo <em>conf_template.inp</em></p></li>
<li><p>Para ejecutar los scripts en bash, primero se les debe dar
permiso de ejecución, por ejemplo, así: <em>chmod +x
01-create_conf-cfm.sh</em> y luego correrlos de la siguiente manera:
<em>./01-create_conf-cfm.sh</em></p></li>
</ul>
<p>Todo lo anterior generará las carpetas y los archivos necesarios para
poder realizar Umbrella Sampling (QM/MM MD) utilizando la interfaz
CHARMM-Gaussian.</p>
<p>Como ejemplo, el resultado sería algo así:</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="pictures/result.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div class="sourceCode" id="cb7"><pre
class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
